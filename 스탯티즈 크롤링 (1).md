```python
!pip install selenium
```

    Collecting selenium
      Downloading selenium-4.5.0-py3-none-any.whl (995 kB)
    Collecting certifi>=2021.10.8
      Downloading certifi-2022.9.24-py3-none-any.whl (161 kB)
    Collecting trio-websocket~=0.9
      Downloading trio_websocket-0.9.2-py3-none-any.whl (16 kB)
    Collecting urllib3[socks]~=1.26
      Downloading urllib3-1.26.12-py2.py3-none-any.whl (140 kB)
    Collecting trio~=0.17
      Downloading trio-0.22.0-py3-none-any.whl (384 kB)
    Requirement already satisfied: async-generator>=1.10 in c:\anaconda\lib\site-packages (from trio-websocket~=0.9->selenium) (1.10)
    Collecting wsproto>=0.14
      Downloading wsproto-1.2.0-py3-none-any.whl (24 kB)
    Requirement already satisfied: PySocks!=1.5.7,<2.0,>=1.5.6; extra == "socks" in c:\anaconda\lib\site-packages (from urllib3[socks]~=1.26->selenium) (1.7.1)
    Collecting exceptiongroup>=1.0.0rc9; python_version < "3.11"
      Downloading exceptiongroup-1.0.0rc9-py3-none-any.whl (12 kB)
    Requirement already satisfied: attrs>=19.2.0 in c:\anaconda\lib\site-packages (from trio~=0.17->selenium) (20.3.0)
    Collecting sniffio
      Downloading sniffio-1.3.0-py3-none-any.whl (10 kB)
    Requirement already satisfied: idna in c:\anaconda\lib\site-packages (from trio~=0.17->selenium) (2.10)
    Requirement already satisfied: cffi>=1.14; os_name == "nt" and implementation_name != "pypy" in c:\anaconda\lib\site-packages (from trio~=0.17->selenium) (1.14.3)
    Requirement already satisfied: sortedcontainers in c:\anaconda\lib\site-packages (from trio~=0.17->selenium) (2.2.2)
    Collecting outcome
      Downloading outcome-1.2.0-py2.py3-none-any.whl (9.7 kB)
    Collecting h11<1,>=0.9.0
      Downloading h11-0.14.0-py3-none-any.whl (58 kB)
    Requirement already satisfied: pycparser in c:\anaconda\lib\site-packages (from cffi>=1.14; os_name == "nt" and implementation_name != "pypy"->trio~=0.17->selenium) (2.20)
    Installing collected packages: certifi, exceptiongroup, sniffio, outcome, trio, h11, wsproto, trio-websocket, urllib3, selenium
      Attempting uninstall: certifi
        Found existing installation: certifi 2020.6.20
        Uninstalling certifi-2020.6.20:
          Successfully uninstalled certifi-2020.6.20
      Attempting uninstall: urllib3
        Found existing installation: urllib3 1.25.11
        Uninstalling urllib3-1.25.11:
          Successfully uninstalled urllib3-1.25.11
    Successfully installed certifi-2022.9.24 exceptiongroup-1.0.0rc9 h11-0.14.0 outcome-1.2.0 selenium-4.5.0 sniffio-1.3.0 trio-0.22.0 trio-websocket-0.9.2 urllib3-1.26.12 wsproto-1.2.0
    

    ERROR: After October 2020 you may experience errors when installing or updating packages. This is because pip will change the way that it resolves dependency conflicts.
    
    We recommend you use --use-feature=2020-resolver to test your packages with the new resolver before it becomes the default.
    
    requests 2.24.0 requires urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1, but you'll have urllib3 1.26.12 which is incompatible.
    <ipython-input-4-3cc969f3da78>:3: DeprecationWarning: executable_path has been deprecated, please pass in a Service object
      driver = webdriver.Chrome("/downloads/chromedriver_win32/chromedriver.exe")
    


    ---------------------------------------------------------------------------

    FileNotFoundError                         Traceback (most recent call last)

    C:\anaconda\lib\site-packages\selenium\webdriver\common\service.py in start(self)
         70             cmd.extend(self.command_line_args())
    ---> 71             self.process = subprocess.Popen(cmd, env=self.env,
         72                                             close_fds=system() != 'Windows',
    

    C:\anaconda\lib\subprocess.py in __init__(self, args, bufsize, executable, stdin, stdout, stderr, preexec_fn, close_fds, shell, cwd, env, universal_newlines, startupinfo, creationflags, restore_signals, start_new_session, pass_fds, encoding, errors, text)
        853 
    --> 854             self._execute_child(args, executable, preexec_fn, close_fds,
        855                                 pass_fds, cwd, env,
    

    C:\anaconda\lib\subprocess.py in _execute_child(self, args, executable, preexec_fn, close_fds, pass_fds, cwd, env, startupinfo, creationflags, shell, p2cread, p2cwrite, c2pread, c2pwrite, errread, errwrite, unused_restore_signals, unused_start_new_session)
       1306             try:
    -> 1307                 hp, ht, pid, tid = _winapi.CreateProcess(executable, args,
       1308                                          # no special security
    

    FileNotFoundError: [WinError 2] 지정된 파일을 찾을 수 없습니다

    
    During handling of the above exception, another exception occurred:
    

    WebDriverException                        Traceback (most recent call last)

    <ipython-input-4-3cc969f3da78> in <module>
          1 get_ipython().system('pip install selenium')
          2 from selenium import webdriver
    ----> 3 driver = webdriver.Chrome("/downloads/chromedriver_win32/chromedriver.exe")
    

    C:\anaconda\lib\site-packages\selenium\webdriver\chrome\webdriver.py in __init__(self, executable_path, port, options, service_args, desired_capabilities, service_log_path, chrome_options, service, keep_alive)
         67             service = Service(executable_path, port, service_args, service_log_path)
         68 
    ---> 69         super().__init__(DesiredCapabilities.CHROME['browserName'], "goog",
         70                          port, options,
         71                          service_args, desired_capabilities,
    

    C:\anaconda\lib\site-packages\selenium\webdriver\chromium\webdriver.py in __init__(self, browser_name, vendor_prefix, port, options, service_args, desired_capabilities, service_log_path, service, keep_alive)
         87 
         88         self.service = service
    ---> 89         self.service.start()
         90 
         91         try:
    

    C:\anaconda\lib\site-packages\selenium\webdriver\common\service.py in start(self)
         79         except OSError as err:
         80             if err.errno == errno.ENOENT:
    ---> 81                 raise WebDriverException(
         82                     "'{}' executable needs to be in PATH. {}".format(
         83                         os.path.basename(self.path), self.start_error_message)
    

    WebDriverException: Message: 'chromedriver.exe' executable needs to be in PATH. Please see https://chromedriver.chromium.org/home
    



```python
import selenium
from selenium import webdriver
from selenium.webdriver import ActionChains

from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By

from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.support.ui import Select
from selenium.webdriver.support.ui import WebDriverWait

from bs4 import BeautifulSoup

import pandas as pd
import numpy as np

import re
```


```python
#http://www.statiz.co.kr/stat.php?mid=stat&re=0&ys=1982&ye=2018&sn=30&pa=0
#ys,ye로 연도 조정, sn으로 출력 선수 수 지정, pa로 시작 순위 지정
```


```python
driver = webdriver.Chrome(executable_path = "C:/Users/희준/downloads/chromedriver_win32/chromedriver.exe")
```

    <ipython-input-7-4f27b00cb06d>:1: DeprecationWarning: executable_path has been deprecated, please pass in a Service object
      driver = webdriver.Chrome(executable_path = "C:/Users/희준/downloads/chromedriver_win32/chromedriver.exe")
    


```python
for i in range(93):
    url = 'http://www.statiz.co.kr/stat.php?mid=stat&re=0&ys=1982&ye=2022&sn=100&pa={}'.format(i*100)
    driver.get(url)
    driver.implicitly_wait(time_to_wait=5)
    html = driver.find_element(By.XPATH,'//*[@id="mytable"]/tbody').get_attribute("innerHTML")
    soup = BeautifulSoup(html, 'html.parser')

    temp = [i.text.strip() for i in soup.findAll("tr")] #tr태그에서 text만 저장하고 공백 제거
    temp = pd.Series(temp) #list 객체를 series 객체로 변경
    
    #중간중간에 '순'이나 'WAR'로 시작하는 행들이 있는데 이를 제거해준다
    #그리고 index를 reset
    temp = temp[~temp.str.match("[순W]")].reset_index(drop=True)
    
    #띄어쓰기 기준으로 분류해서 데이터프레임으로 만들기
    temp = temp.apply(lambda x: pd.Series(x.split(' ')))
    
    #선수 팀 정보 이후 첫번째 기록과는 space 하나로 구분, 그 이후로는 space 두개로 구분이 되어 있음 
    #그래서 space 하나로 구분을 시키면, 빈 column들이 존재 하는데, 해당 column들 제거 
    temp = temp.replace('', np.nan).dropna(axis=1) 
    
    #WAR이 두 열이나 존재해서 처음 나오는 WAR열을 삭제. 1열에 있음
    temp = temp.drop(1,axis=1)
    
    #선수 이름 앞의 숫자 제거
    temp[0] = temp[0].str.replace("^\d+", "")
    
    #선수들의 생일 정보가 담긴 tag들 가져오기
    birth = [i.find("a") for i in soup.findAll('tr') if 'birth' in i.find('a').attrs['href']]
    
    #tag에서 생일만 추출하기
    p = re.compile("\d{4}\-\d{2}\-\d{2}")
    birth = [p.findall(i.attrs['href'])[0] for i in birth]
    
    temp['생일']=birth
    
    if i ==0:
        result = temp
    else:
        result = result.append(temp)
        result = result.reset_index(drop=True)
    print(i, "완료")
    
columns = ['선수'] + [i.text for i in soup.findAll("tr")[0].findAll("th")][4:-3] + ['타율','출루율','장타율','OPS','wOBA','wRC+','WAR+','생일']
result.columns = columns

driver.close()
```

    0 완료
    1 완료
    2 완료
    3 완료
    4 완료
    5 완료
    6 완료
    7 완료
    8 완료
    9 완료
    10 완료
    11 완료
    12 완료
    13 완료
    14 완료
    15 완료
    16 완료
    17 완료
    18 완료
    19 완료
    20 완료
    21 완료
    22 완료
    23 완료
    24 완료
    25 완료
    26 완료
    27 완료
    28 완료
    29 완료
    30 완료
    31 완료
    32 완료
    33 완료
    34 완료
    35 완료
    36 완료
    37 완료
    38 완료
    39 완료
    40 완료
    41 완료
    42 완료
    43 완료
    44 완료
    45 완료
    46 완료
    47 완료
    48 완료
    49 완료
    50 완료
    51 완료
    52 완료
    53 완료
    54 완료
    55 완료
    56 완료
    57 완료
    58 완료
    59 완료
    60 완료
    61 완료
    62 완료
    63 완료
    64 완료
    65 완료
    66 완료
    67 완료
    68 완료
    69 완료
    70 완료
    71 완료
    72 완료
    73 완료
    74 완료
    75 완료
    76 완료
    77 완료
    78 완료
    79 완료
    80 완료
    81 완료
    82 완료
    83 완료
    84 완료
    85 완료
    86 완료
    87 완료
    88 완료
    89 완료
    90 완료
    91 완료
    92 완료
    


```python
result.to_csv("statiz_crawling_batter_82_to_22_9300rows")
```


```python
driver = webdriver.Chrome(executable_path = "C:/Users/희준/downloads/chromedriver_win32/chromedriver.exe")
```

    <ipython-input-18-4f27b00cb06d>:1: DeprecationWarning: executable_path has been deprecated, please pass in a Service object
      driver = webdriver.Chrome(executable_path = "C:/Users/희준/downloads/chromedriver_win32/chromedriver.exe")
    


```python
for i in range(1):
    url = 'http://www.statiz.co.kr/stat.php?mid=stat&re=0&ys=2022&ye=2022&sn=100&pa={}'.format(i*100)
    driver.get(url)
    driver.implicitly_wait(time_to_wait=5)
    html = driver.find_element(By.XPATH,'//*[@id="mytable"]/tbody').get_attribute("innerHTML")
    soup = BeautifulSoup(html, 'html.parser')

    temp = [i.text.strip() for i in soup.findAll("tr")] #tr태그에서 text만 저장하고 공백 제거
    temp = pd.Series(temp) #list 객체를 series 객체로 변경
    
    #중간중간에 '순'이나 'WAR'로 시작하는 행들이 있는데 이를 제거해준다
    #그리고 index를 reset
    temp = temp[~temp.str.match("[순W]")].reset_index(drop=True)
    
    #띄어쓰기 기준으로 분류해서 데이터프레임으로 만들기
    temp = temp.apply(lambda x: pd.Series(x.split(' ')))
    
    #선수 팀 정보 이후 첫번째 기록과는 space 하나로 구분, 그 이후로는 space 두개로 구분이 되어 있음 
    #그래서 space 하나로 구분을 시키면, 빈 column들이 존재 하는데, 해당 column들 제거 
    temp = temp.replace('', np.nan).dropna(axis=1) 
    
    #WAR이 두 열이나 존재해서 처음 나오는 WAR열을 삭제. 1열에 있음
    temp = temp.drop(1,axis=1)
    
    #선수 이름 앞의 숫자 제거
    temp[0] = temp[0].str.replace("^\d+", "")
    
    #선수들의 생일 정보가 담긴 tag들 가져오기
    birth = [i.find("a") for i in soup.findAll('tr') if 'birth' in i.find('a').attrs['href']]
    
    #tag에서 생일만 추출하기
    p = re.compile("\d{4}")
    birth = [p.findall(i.attrs['href'])[0] for i in birth]
    
    temp['생일']=birth
    
    if i ==0:
        result = temp
    else:
        result = result.append(temp)
        result = result.reset_index(drop=True)
    print(i, "완료")
    
columns = ['선수'] + [i.text for i in soup.findAll("tr")[0].findAll("th")][4:-3] + ['타율','출루율','장타율','OPS','wOBA','wRC+','WAR+','WPA','생년']
result.columns = columns

driver.close()
```

    0 완료
    


```python
result.columns
```




    Index(['선수', 'G', '타석', '타수', '득점', '안타', '2타', '3타', '홈런', '루타', '타점', '도루',
           '도실', '볼넷', '사구', '고4', '삼진', '병살', '희타', '희비', '타율', '출루율', '장타율',
           'OPS', 'wOBA', 'wRC+', 'WAR+', 'WPA', '생일'],
          dtype='object')




```python
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선수</th>
      <th>G</th>
      <th>타석</th>
      <th>타수</th>
      <th>득점</th>
      <th>안타</th>
      <th>2타</th>
      <th>3타</th>
      <th>홈런</th>
      <th>루타</th>
      <th>...</th>
      <th>희비</th>
      <th>타율</th>
      <th>출루율</th>
      <th>장타율</th>
      <th>OPS</th>
      <th>wOBA</th>
      <th>wRC+</th>
      <th>WAR+</th>
      <th>WPA</th>
      <th>생년</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>이정후22키CF</td>
      <td>142</td>
      <td>627</td>
      <td>553</td>
      <td>85</td>
      <td>193</td>
      <td>36</td>
      <td>10</td>
      <td>23</td>
      <td>318</td>
      <td>...</td>
      <td>3</td>
      <td>.349</td>
      <td>.421</td>
      <td>.575</td>
      <td>.996</td>
      <td>.441</td>
      <td>182.5</td>
      <td>9.23</td>
      <td>6.72</td>
      <td>1998</td>
    </tr>
    <tr>
      <th>1</th>
      <td>피렐라22삼LF</td>
      <td>141</td>
      <td>630</td>
      <td>561</td>
      <td>102</td>
      <td>192</td>
      <td>33</td>
      <td>4</td>
      <td>28</td>
      <td>317</td>
      <td>...</td>
      <td>2</td>
      <td>.342</td>
      <td>.411</td>
      <td>.565</td>
      <td>.976</td>
      <td>.434</td>
      <td>169.3</td>
      <td>7.40</td>
      <td>4.20</td>
      <td>1989</td>
    </tr>
    <tr>
      <th>2</th>
      <td>나성범22KRF</td>
      <td>144</td>
      <td>649</td>
      <td>563</td>
      <td>92</td>
      <td>180</td>
      <td>39</td>
      <td>2</td>
      <td>21</td>
      <td>286</td>
      <td>...</td>
      <td>5</td>
      <td>.320</td>
      <td>.402</td>
      <td>.508</td>
      <td>.910</td>
      <td>.411</td>
      <td>157.4</td>
      <td>6.50</td>
      <td>3.74</td>
      <td>1989</td>
    </tr>
    <tr>
      <th>3</th>
      <td>오지환22LSS</td>
      <td>142</td>
      <td>569</td>
      <td>494</td>
      <td>75</td>
      <td>133</td>
      <td>16</td>
      <td>4</td>
      <td>25</td>
      <td>232</td>
      <td>...</td>
      <td>3</td>
      <td>.269</td>
      <td>.357</td>
      <td>.470</td>
      <td>.827</td>
      <td>.372</td>
      <td>138.6</td>
      <td>5.77</td>
      <td>2.56</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>4</th>
      <td>최정22S3B</td>
      <td>121</td>
      <td>505</td>
      <td>414</td>
      <td>80</td>
      <td>110</td>
      <td>21</td>
      <td>0</td>
      <td>26</td>
      <td>209</td>
      <td>...</td>
      <td>6</td>
      <td>.266</td>
      <td>.386</td>
      <td>.505</td>
      <td>.891</td>
      <td>.400</td>
      <td>145.4</td>
      <td>5.15</td>
      <td>3.72</td>
      <td>1987</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>고종욱22KDH</td>
      <td>62</td>
      <td>114</td>
      <td>106</td>
      <td>13</td>
      <td>30</td>
      <td>7</td>
      <td>1</td>
      <td>2</td>
      <td>45</td>
      <td>...</td>
      <td>0</td>
      <td>.283</td>
      <td>.327</td>
      <td>.425</td>
      <td>.752</td>
      <td>.341</td>
      <td>110.4</td>
      <td>0.40</td>
      <td>0.63</td>
      <td>1989</td>
    </tr>
    <tr>
      <th>96</th>
      <td>김기환22NCF</td>
      <td>73</td>
      <td>131</td>
      <td>113</td>
      <td>26</td>
      <td>25</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>32</td>
      <td>...</td>
      <td>1</td>
      <td>.221</td>
      <td>.310</td>
      <td>.283</td>
      <td>.593</td>
      <td>.282</td>
      <td>71.0</td>
      <td>0.37</td>
      <td>-1.17</td>
      <td>1995</td>
    </tr>
    <tr>
      <th>97</th>
      <td>김주형22키SS</td>
      <td>55</td>
      <td>130</td>
      <td>110</td>
      <td>16</td>
      <td>22</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>34</td>
      <td>...</td>
      <td>1</td>
      <td>.200</td>
      <td>.305</td>
      <td>.309</td>
      <td>.614</td>
      <td>.291</td>
      <td>76.0</td>
      <td>0.33</td>
      <td>-0.93</td>
      <td>1996</td>
    </tr>
    <tr>
      <th>98</th>
      <td>박상언22한C</td>
      <td>56</td>
      <td>151</td>
      <td>134</td>
      <td>16</td>
      <td>30</td>
      <td>5</td>
      <td>1</td>
      <td>4</td>
      <td>49</td>
      <td>...</td>
      <td>1</td>
      <td>.224</td>
      <td>.281</td>
      <td>.366</td>
      <td>.647</td>
      <td>.287</td>
      <td>73.4</td>
      <td>0.32</td>
      <td>-0.83</td>
      <td>1997</td>
    </tr>
    <tr>
      <th>99</th>
      <td>안승한22두C</td>
      <td>30</td>
      <td>39</td>
      <td>36</td>
      <td>5</td>
      <td>12</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>15</td>
      <td>...</td>
      <td>0</td>
      <td>.333</td>
      <td>.368</td>
      <td>.417</td>
      <td>.785</td>
      <td>.356</td>
      <td>122.1</td>
      <td>0.32</td>
      <td>0.21</td>
      <td>1992</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 29 columns</p>
</div>




```python
result['선수'].str.slice(0,3)
```




    0     이정후
    1     피렐라
    2     나성범
    3     오지환
    4     최정2
         ... 
    95    고종욱
    96    김기환
    97    김주형
    98    박상언
    99    안승한
    Name: 선수, Length: 100, dtype: object




```python
result['선수'].map(lambda x:x[:x.find('22')])
```




    0     이정후
    1     피렐라
    2     나성범
    3     오지환
    4      최정
         ... 
    95    고종욱
    96    김기환
    97    김주형
    98    박상언
    99    안승한
    Name: 선수, Length: 100, dtype: object




```python
result['선수'].map(lambda x:x[x.find('22')+3:])
```




    0     CF
    1     LF
    2     RF
    3     SS
    4     3B
          ..
    95    DH
    96    CF
    97    SS
    98     C
    99     C
    Name: 선수, Length: 100, dtype: object




```python
result['포지션'] = result['선수'].map(lambda x:x[x.find('22')+3:])
```
